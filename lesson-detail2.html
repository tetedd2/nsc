<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‚Äì ‡∏ö‡∏ó‡∏ó‡∏µ‡πà 2 ‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏°‡πÄ‡∏á‡∏¥‡∏ô</title>
  <link rel="stylesheet" href="theme-darkmode.css" />
  <script async src="https://www.tiktok.com/embed.js"></script>
  <style>
    body { margin:0; font-family:'Segoe UI',sans-serif; background-color:#eaf4f4; }
    .header { background-color:#009688; color:white; padding:20px; text-align:center; }
    .container { padding:20px; max-width:800px; margin:0 auto; }
    .lesson-title { color:#004d40; font-size:1.7rem; margin-bottom:18px; }
    .lesson-content { font-size:1.07rem; color:#444; line-height:1.9; margin-bottom:24px; }
    .pagination { text-align:center; margin:28px 0 10px 0; }
    .page-btn { display:inline-block; background:#009688; color:#fff; padding:8px 20px; border-radius:7px; text-decoration:none; margin:0 12px; transition:background 0.2s; }
    .page-btn:disabled, .disabled { background:#ccc !important; color:#888; pointer-events:none; }
    .back-btn { margin-top:30px; display:inline-block; background:#009688; color:#fff; padding:10px 18px; border-radius:8px; text-decoration:none; transition:background 0.2s; }
    .save-btn { background:#009688; color:#fff; border:none; border-radius:7px; padding:10px 20px; margin-top:15px; cursor:pointer; }
    .quiz-status { margin-left:16px; font-weight:bold; }
    .video-container { margin: 24px 0; border-radius: 8px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
    .video-wrapper { position: relative; width: 100%; padding-bottom: 56.25%; height: 0; }
    .video-wrapper iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0; }
    .end-of-chapter-quiz .question { background-color: #f9f9f9; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 5px solid #009688; }
    .end-of-chapter-quiz .question-text { font-size: 1.1em; font-weight: 600; margin-bottom: 10px; }
    .end-of-chapter-quiz .choices { display: flex; flex-direction: column; gap: 10px; }
    .end-of-chapter-quiz .choice { background-color: #fff; border: 1px solid #ddd; border-radius: 5px; padding: 10px; cursor: pointer; display: block; }
    #quizResult.correct { color: #388e3c; }
    #quizResult.incorrect { color: #d32f2f; }
  </style>
</head>
<body>
  <div class="header"><h1>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô: ‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏°‡πÄ‡∏á‡∏¥‡∏ô</h1></div>
  <div class="container">
    <div id="lessonDetails"></div>
    <div class="pagination" id="pagination"></div>
    <a href="lesson.html" class="back-btn">‚¨Ö ‡∏Å‡∏•‡∏±‡∏ö‡∏™‡∏π‡πà‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</a>
  </div>
  <script>
    const lessonId = 2;
    const urlParams = new URLSearchParams(window.location.search);
    const pageNow = Number(urlParams.get("page")||1);

    const pages = [
       {
        title: "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 2: ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡πÑ‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏≠‡∏° (‡∏´‡∏ô‡πâ‡∏≤ 1/5)",
        content: `
          <div>
            <b>‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏°‡πÄ‡∏á‡∏¥‡∏ô</b> ‡∏Ñ‡∏∑‡∏≠ ‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏ô‡∏∂‡πà‡∏á‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ ‡πÑ‡∏°‡πà‡∏ô‡∏≥‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï<br>
            <b>‡∏ó‡∏≥‡πÑ‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏≠‡∏°?</b>
            <ul>
              <li>‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ ‡πÄ‡∏ä‡πà‡∏ô ‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á, ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©</li>
              <li>‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏¢‡∏≤‡∏°‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô ‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏à‡πá‡∏ö‡∏õ‡πà‡∏ß‡∏¢</li>
              <li>‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡πÉ‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏≤‡∏ß</li>
              <li>‡∏ù‡∏∂‡∏Å‡∏ß‡∏¥‡∏ô‡∏±‡∏¢‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡∏ï‡πà‡∏≠‡∏ï‡∏ô‡πÄ‡∏≠‡∏á</li>
            </ul>
          </div>
        `
      },
      {
        title: "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 2: ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏±‡∏¢‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (‡∏´‡∏ô‡πâ‡∏≤ 2/5)",
        content: `
          <div>
            <b>‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏¢‡∏≠‡∏î‡∏ô‡∏¥‡∏¢‡∏°</b><br>
            <ul>
              <li><b>‡∏≠‡∏≠‡∏°‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä‡πâ (Pay Yourself First):</b> ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏°‡∏≤ ‡πÉ‡∏´‡πâ‡∏´‡∏±‡∏Å‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏≠‡∏≠‡∏°‡∏≠‡∏≠‡∏Å‡πÑ‡∏õ‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ 10-20% ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏Ñ‡πà‡∏≠‡∏¢‡∏ô‡∏≥‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢</li>
              <li><b>‡∏≠‡∏≠‡∏°‡πÄ‡∏®‡∏©‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç:</b> ‡∏ó‡∏∏‡∏Å‡∏™‡∏¥‡πâ‡∏ô‡∏ß‡∏±‡∏ô ‡∏ô‡∏≥‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÉ‡∏ô‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏°‡∏≤‡∏´‡∏¢‡∏≠‡∏î‡∏Å‡∏£‡∏∞‡∏õ‡∏∏‡∏Å</li>
              <li><b>‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏†‡∏≤‡∏û:</b> ‡∏ï‡∏¥‡∏î‡∏£‡∏π‡∏õ‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡πÑ‡∏î‡πâ‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏∞‡∏õ‡∏∏‡∏Å‡∏≠‡∏≠‡∏°‡∏™‡∏¥‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏£‡∏á‡∏ö‡∏±‡∏ô‡∏î‡∏≤‡∏•‡πÉ‡∏à</li>
            </ul>
             <div class="video-container">
              <div class="video-wrapper">
                <iframe src="https://www.youtube.com/embed/OUO2unyOv78" title="YouTube video player" allowfullscreen></iframe>
              </div>
            </div>
          </div>
        `
      },
      {
        title: "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 2: ‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏°‡πÅ‡∏ö‡∏ö SMART (‡∏´‡∏ô‡πâ‡∏≤ 3/5)",
        content: `
          <div>
            ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡∏≠‡∏≠‡∏°‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏î‡πâ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏£‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ö‡∏ö <b>SMART</b>:
            <ul>
              <li><b>S (Specific):</b> ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏à‡∏≤‡∏∞‡∏à‡∏á - ‡∏à‡∏∞‡∏≠‡∏≠‡∏°‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏∞‡πÑ‡∏£? (‡πÄ‡∏ä‡πà‡∏ô ‡∏ã‡∏∑‡πâ‡∏≠‡∏´‡∏π‡∏ü‡∏±‡∏á‡πÑ‡∏£‡πâ‡∏™‡∏≤‡∏¢)</li>
              <li><b>M (Measurable):</b> ‡∏ß‡∏±‡∏î‡∏ú‡∏•‡πÑ‡∏î‡πâ - ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏´‡∏£‡πà? (‡πÄ‡∏ä‡πà‡∏ô 1,500 ‡∏ö‡∏≤‡∏ó)</li>
              <li><b>A (Achievable):</b> ‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á - ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà? (‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏•‡∏∞ 500 ‡∏ö‡∏≤‡∏ó)</li>
              <li><b>R (Relevant):</b> ‡∏™‡∏°‡πÄ‡∏´‡∏ï‡∏∏‡∏™‡∏°‡∏ú‡∏• - ‡∏™‡∏¥‡πà‡∏á‡∏ô‡∏µ‡πâ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?</li>
              <li><b>T (Time-bound):</b> ‡∏°‡∏µ‡∏Å‡∏£‡∏≠‡∏ö‡πÄ‡∏ß‡∏•‡∏≤ - ‡∏à‡∏∞‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏´‡∏£‡πà? (‡πÄ‡∏ä‡πà‡∏ô ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 3 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)</li>
            </ul>
          </div>
        `
      },
      {
        title: "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 2: ‡∏≠‡∏∏‡∏õ‡∏™‡∏£‡∏£‡∏Ñ‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏≠‡∏≤‡∏ä‡∏ô‡∏∞‡πÉ‡∏à‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á (‡∏´‡∏ô‡πâ‡∏≤ 4/5)",
        content: `
          <div>
            <b>‡∏≠‡∏∏‡∏õ‡∏™‡∏£‡∏£‡∏Ñ‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢:</b>
            <ol>
              <li><b>‡πÉ‡∏à‡∏≠‡πà‡∏≠‡∏ô:</b> ‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏à‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏π‡πà</li>
              <li><b>‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢:</b> ‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏à‡∏∞‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏õ‡∏ó‡∏≥‡πÑ‡∏° ‡πÄ‡∏•‡∏¢‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÅ‡∏£‡∏á‡∏à‡∏π‡∏á‡πÉ‡∏à</li>
              <li><b>‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡∏ô‡πâ‡∏≠‡∏¢:</b> ‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡∏Ñ‡πà‡∏≤‡∏Ç‡∏ô‡∏°‡πÑ‡∏°‡πà‡∏û‡∏≠‡∏≠‡∏≠‡∏°</li>
            </ol>
            <b>‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏≠‡∏≤‡∏ä‡∏ô‡∏∞:</b>
            <ul>
                <li>‡πÉ‡∏ä‡πâ‡∏Å‡∏é "‡∏£‡∏≠ 24 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á" ‡∏Å‡πà‡∏≠‡∏ô‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô</li>
                <li>‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡πÅ‡∏õ‡∏∞‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡πÄ‡∏´‡πá‡∏ô‡∏ö‡πà‡∏≠‡∏¢‡πÜ</li>
                <li>‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏≠‡∏≠‡∏°‡∏à‡∏≤‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡πâ‡∏≠‡∏¢‡πÜ ‡∏Å‡πà‡∏≠‡∏ô ‡πÄ‡∏ä‡πà‡∏ô ‡∏ß‡∏±‡∏ô‡∏•‡∏∞ 5-10 ‡∏ö‡∏≤‡∏ó ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ô‡∏¥‡∏™‡∏±‡∏¢</li>
            </ul>
          </div>
        `
      },
      {
        title: "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 2: ‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ó‡πâ‡∏≤‡∏¢‡∏ö‡∏ó (‡∏´‡∏ô‡πâ‡∏≤ 5/5)",
        content: `
          <div class="end-of-chapter-quiz" id="end-of-chapter-quiz"></div>
          <button type="button" class="save-btn" id="checkQuizBtn">‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</button>
          <span id="quizResult" class="quiz-status"></span>
          <div style="margin-top:16px;">
            <button id="doneBtn" class="save-btn disabled" style="background:#388e3c;">‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏à‡∏ö‡∏ö‡∏ó‡∏ô‡∏µ‡πâ</button>
            <span id="doneStatus" class="quiz-status"></span>
          </div>
        `
      }
    ];

    let page = Math.min(Math.max(pageNow,1), pages.length);
    document.getElementById("lessonDetails").innerHTML = `<div class="lesson-title">${pages[page-1].title}</div><div class="lesson-content">${pages[page-1].content}</div>`;
    let pag = "";
    if (page > 1) pag += `<a class="page-btn" href="lesson-detail2.html?page=${page-1}">‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</a>`;
    if (page < pages.length) pag += `<a class="page-btn" href="lesson-detail2.html?page=${page+1}">‡∏´‡∏ô‡πâ‡∏≤‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</a>`;
    document.getElementById("pagination").innerHTML = pag;

    if (page === pages.length) {
      const quizData = [
          {
              question: "‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£ '‡∏≠‡∏≠‡∏°‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä‡πâ' (Pay Yourself First) ‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á‡∏≠‡∏∞‡πÑ‡∏£?",
              choices: ["‡πÉ‡∏ä‡πâ‡πÄ‡∏á‡∏¥‡∏ô‡πÉ‡∏´‡πâ‡∏´‡∏°‡∏î‡∏Å‡πà‡∏≠‡∏ô‡∏™‡∏¥‡πâ‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô", "‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏´‡πâ‡∏´‡∏±‡∏Å‡∏≠‡∏≠‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏≥‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢", "‡∏ô‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏à‡∏≤‡∏Å‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏°‡∏≤‡∏≠‡∏≠‡∏°", "‡∏¢‡∏∑‡∏°‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏°‡∏≤‡∏≠‡∏≠‡∏°‡∏Å‡πà‡∏≠‡∏ô"],
              answer: "‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏´‡πâ‡∏´‡∏±‡∏Å‡∏≠‡∏≠‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏≥‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢"
          },
          {
              question: "‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏°‡πÅ‡∏ö‡∏ö SMART ‡∏ï‡∏±‡∏ß 'T' ‡∏¢‡πà‡∏≠‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏≠‡∏∞‡πÑ‡∏£?",
              choices: ["Time-bound (‡∏°‡∏µ‡∏Å‡∏£‡∏≠‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô)", "Trust (‡∏ô‡πà‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏ñ‡∏∑‡∏≠)", "Tactic (‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå)", "Total (‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°)"],
              answer: "Time-bound (‡∏°‡∏µ‡∏Å‡∏£‡∏≠‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô)"
          },
          {
              question: "‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏î‡∏ä‡πà‡∏ß‡∏¢‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏£‡∏á‡∏à‡∏π‡∏á‡πÉ‡∏à‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏°‡πÑ‡∏î‡πâ‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î?",
              choices: ["‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡∏°‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô", "‡∏ö‡∏≠‡∏Å‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏ü‡∏±‡∏á", "‡∏ï‡∏¥‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡πÑ‡∏î‡πâ‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏∞‡∏õ‡∏∏‡∏Å‡∏≠‡∏≠‡∏°‡∏™‡∏¥‡∏ô", "‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢"],
              answer: "‡∏ï‡∏¥‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡πÑ‡∏î‡πâ‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏∞‡∏õ‡∏∏‡∏Å‡∏≠‡∏≠‡∏°‡∏™‡∏¥‡∏ô"
          }
      ];

      const quizContainer = document.getElementById('end-of-chapter-quiz');
      const checkButton = document.getElementById('checkQuizBtn');
      const resultContainer = document.getElementById('quizResult');
      const doneBtn = document.getElementById("doneBtn");
      const doneStatus = document.getElementById("doneStatus");

      function buildEndOfChapterQuiz() {
          quizData.forEach((currentQuestion, questionNumber) => {
              const choicesHTML = currentQuestion.choices.map(choice => `
                  <label class="choice">
                      <input type="radio" name="chapter_question${questionNumber}" value="${choice}">
                      ${choice}
                  </label>
              `).join('');
              const questionHTML = `
                  <div class="question">
                      <div class="question-text">${questionNumber + 1}. ${currentQuestion.question}</div>
                      <div class="choices">${choicesHTML}</div>
                  </div>
              `;
              quizContainer.innerHTML += questionHTML;
          });
      }

      function checkQuizAnswers() {
          const answerContainers = quizContainer.querySelectorAll('.choices');
          let numCorrect = 0;
          let allAnswered = true;
          quizData.forEach((currentQuestion, questionNumber) => {
              const selector = `input[name=chapter_question${questionNumber}]:checked`;
              const userAnswerNode = answerContainers[questionNumber].querySelector(selector);
              if (!userAnswerNode) { allAnswered = false; return; }
              if (userAnswerNode.value === currentQuestion.answer) numCorrect++;
          });

          if (!allAnswered) {
              resultContainer.textContent = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ç‡πâ‡∏≠";
              resultContainer.className = "quiz-status incorrect";
              return;
          }
          if (numCorrect === quizData.length) {
              resultContainer.textContent = "‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å! ‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏≠‡∏ö‡∏ñ‡∏π‡∏Å‡∏ó‡∏∏‡∏Å‡∏Ç‡πâ‡∏≠";
              resultContainer.className = "quiz-status correct";
              doneBtn.disabled = false;
              doneBtn.classList.remove('disabled');
              doneStatus.textContent = "‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Å‡∏î‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏ö‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß!";
          } else {
              resultContainer.textContent = `‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏≠‡∏µ‡∏Å‡∏ô‡∏¥‡∏î! ‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏≠‡∏ö‡∏ñ‡∏π‡∏Å ${numCorrect} ‡∏à‡∏≤‡∏Å ${quizData.length} ‡∏Ç‡πâ‡∏≠`;
              resultContainer.className = "quiz-status incorrect";
              doneBtn.disabled = true;
              doneBtn.classList.add('disabled');
              doneStatus.textContent = "";
          }
      }
      
      function finishLesson() {
        if (window.completeLessonInFirestore) {
            window.completeLessonInFirestore(lessonId, 80);
        } else {
            console.error("Firebase script not loaded. Saving to localStorage only.");
            localStorage.setItem(`MoneySkillz-lesson${lessonId}-done`, "yes");
            window.checkInitialDoneStatus();
        }
      }

      window.checkInitialDoneStatus = function() {
          if (localStorage.getItem(`MoneySkillz-lesson${lessonId}-done`) === "yes") {
              doneStatus.innerHTML = "‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏à‡∏ö‡∏ö‡∏ó‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡πâ‡∏ß!";
              doneBtn.disabled = true;
              doneBtn.classList.add('disabled');
              if(checkButton) checkButton.style.display = 'none';
              if(resultContainer) resultContainer.style.display = 'none';
          }
      }

      buildEndOfChapterQuiz();
      checkButton.addEventListener('click', checkQuizAnswers);
      doneBtn.addEventListener('click', finishLesson);
      window.checkInitialDoneStatus();
    }
  </script>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
    import { getFirestore, doc, runTransaction, increment, arrayUnion } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

    // YOUR FIREBASE CONFIGURATION
    const firebaseConfig = {
      apiKey: "AIzaSyBjLBl1sEGgQLyng51rW25b434bJ0opVc4",
      authDomain: "myapplication-bd04c034.firebaseapp.com",
      projectId: "myapplication-bd04c034",
      storageBucket: "myapplication-bd04c034.appspot.com",
      messagingSenderId: "49782830313",
      appId: "1:49782830313:web:c81b5d86a937f22d296c78"
    };
  
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // LEVEL CONFIGURATION: ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ XP ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÄ‡∏•‡πÄ‡∏ß‡∏•
    const LEVEL_CONFIG = [
        { level: 1, name: "‡∏ú‡∏π‡πâ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô", xpToNext: 100 },
        { level: 2, name: "‡∏ô‡∏±‡∏Å‡∏≠‡∏≠‡∏°‡∏ù‡∏∂‡∏Å‡∏´‡∏±‡∏î", xpToNext: 250 },
        { level: 3, name: "‡∏ô‡∏±‡∏Å‡∏™‡∏∞‡∏™‡∏°‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç", xpToNext: 500 },
        { level: 4, name: "‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô", xpToNext: 1000 },
        { level: 5, name: "‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏µ‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà", xpToNext: Infinity },
    ];

    /**
     * ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏Å‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏° XP, ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πÄ‡∏ß‡∏•‡∏≠‡∏±‡∏û ‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á Firestore
     * @param {string} uid - User ID ‡∏Ç‡∏≠‡∏á Firebase
     * @param {number} amount - ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô XP ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°
     * @param {number} lessonId - ID ‡∏Ç‡∏≠‡∏á‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏à‡∏ö
     * @returns {Promise<{success: boolean, message: string}>} - ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á
     */
    async function grantXpAndLevelUp(uid, amount, lessonId) {
        if (!uid || !amount || amount <= 0) return { success: false, message: "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á" };
        const userRef = doc(db, 'users', uid);
        let finalMessage = `‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö ${amount} XP`;
        try {
            await runTransaction(db, async (transaction) => {
                const userSnap = await transaction.get(userRef);
                if (!userSnap.exists()) throw new Error("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ");
                
                const userData = userSnap.data();
                const completedLessons = userData.completedLessons || [];

                // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏Ñ‡∏¢‡∏à‡∏ö‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á
                if (completedLessons.includes(lessonId)) {
                    finalMessage = "‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏à‡∏ö‡∏ö‡∏ó‡∏ô‡∏µ‡πâ‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß";
                    return; // ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ XP ‡∏ã‡πâ‡∏≥
                }

                let xp = userData.xp || 0;
                let level = userData.level || 1;
                let nextLevelXP = userData.nextLevelXP || LEVEL_CONFIG[0].xpToNext;
                let totalCoinReward = 0;
                
                xp += amount;

                // ‡∏ß‡∏ô‡∏•‡∏π‡∏õ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πÄ‡∏ß‡∏•‡∏≠‡∏±‡∏û (‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏ì‡∏µ‡πÑ‡∏î‡πâ XP ‡πÄ‡∏¢‡∏≠‡∏∞‡∏à‡∏ô‡πÄ‡∏•‡πÄ‡∏ß‡∏•‡∏≠‡∏±‡∏û‡∏´‡∏•‡∏≤‡∏¢‡∏Ç‡∏±‡πâ‡∏ô)
                while (xp >= nextLevelXP && nextLevelXP !== Infinity) {
                    const currentLevelIndex = LEVEL_CONFIG.findIndex(l => l.level === level);
                    if (currentLevelIndex < LEVEL_CONFIG.length - 1) {
                        const nextLevelInfo = LEVEL_CONFIG[currentLevelIndex + 1];
                        const rewardForThisLevel = 100 + (nextLevelInfo.level * 25); // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•
                        totalCoinReward += rewardForThisLevel;
                        
                        xp -= nextLevelXP; // ‡∏´‡∏±‡∏Å XP ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÄ‡∏•‡πÄ‡∏ß‡∏•‡∏≠‡∏±‡∏û
                        level = nextLevelInfo.level; // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏•‡πÄ‡∏ß‡∏•‡πÉ‡∏´‡∏°‡πà
                        nextLevelXP = nextLevelInfo.xpToNext; // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ XP ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏•‡πÄ‡∏ß‡∏•‡∏ñ‡∏±‡∏î‡πÑ‡∏õ
                        finalMessage += `\nüéâ ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢! ‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏•‡πÄ‡∏ß‡∏•‡∏≠‡∏±‡∏û‡πÄ‡∏õ‡πá‡∏ô Level ${level} ‚Äì ${nextLevelInfo.name}!`;
                    } else {
                        break; // ‡πÄ‡∏•‡πÄ‡∏ß‡∏•‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡πÅ‡∏•‡πâ‡∏ß
                    }
                }

                const finalUpdateData = { xp, level, nextLevelXP, completedLessons: arrayUnion(lessonId) };
                if (totalCoinReward > 0) {
                    finalUpdateData.coins = increment(totalCoinReward);
                    finalMessage += `\n‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö ${totalCoinReward} ‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç!`;
                }
                
                transaction.update(userRef, finalUpdateData);
            });
            return { success: true, message: finalMessage };
        } catch (error) {
            console.error("Error in transaction: ", error);
            return { success: false, message: "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•" };
        }
    }
    
    /**
     * ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏à‡∏≤‡∏Å‡∏õ‡∏∏‡πà‡∏° "‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏à‡∏ö‡∏ö‡∏ó‡∏ô‡∏µ‡πâ" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ XP
     * @param {number} lessonId - ID ‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
     * @param {number} xpToAdd - XP ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÉ‡∏´‡πâ
     */
    window.completeLessonInFirestore = async (lessonId, xpToAdd) => {
        const doneBtn = document.getElementById("doneBtn");
        const doneStatus = document.getElementById("doneStatus");
        if (doneBtn.disabled) return;

        doneBtn.disabled = true;
        doneStatus.textContent = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...";
        
        const user = auth.currentUser;
        if (user) {
            // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô grantXpAndLevelUp
            const result = await grantXpAndLevelUp(user.uid, xpToAdd, lessonId);
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤
            alert(result.message); 
            
            doneStatus.textContent = result.message.split('\n')[0]; // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏£‡∏Å‡∏ó‡∏µ‡πà‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
            if(result.success) {
                localStorage.setItem(`MoneySkillz-lesson${lessonId}-done`, "yes");
                if (window.checkInitialDoneStatus) window.checkInitialDoneStatus();
            } else {
                doneBtn.disabled = false; // ‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡πÉ‡∏´‡πâ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÑ‡∏î‡πâ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
            }
        } else {
            alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏ö XP");
            doneBtn.disabled = false;
            doneStatus.textContent = "‡πÇ‡∏õ‡∏£‡∏î‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö";
        }
    };

    onAuthStateChanged(auth, (user) => {
        if (!user) {
            const doneBtn = document.getElementById("doneBtn");
            if (doneBtn) {
                 // ‡∏´‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ login ‡πÉ‡∏´‡πâ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏õ‡∏∏‡πà‡∏°‡∏à‡∏ö‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
                 doneBtn.disabled = true;
                 doneBtn.closest('.action-btn').textContent = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö";
            }
        }
    });
  </script>
  <script src="darkmode-toggle.js"></script>
</body>
</html>
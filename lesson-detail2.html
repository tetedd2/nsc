<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>รายละเอียดบทเรียน – บทที่ 2 การออมเงิน</title>
  <link rel="stylesheet" href="theme-darkmode.css" />
  <script async src="https://www.tiktok.com/embed.js"></script>
  <style>
    body { margin:0; font-family:'Segoe UI',sans-serif; background-color:#eaf4f4; }
    .header { background-color:#009688; color:white; padding:20px; text-align:center; }
    .container { padding:20px; max-width:800px; margin:0 auto; }
    .lesson-title { color:#004d40; font-size:1.7rem; margin-bottom:18px; }
    .lesson-content { font-size:1.07rem; color:#444; line-height:1.9; margin-bottom:24px; }
    .pagination { text-align:center; margin:28px 0 10px 0; }
    .page-btn { display:inline-block; background:#009688; color:#fff; padding:8px 20px; border-radius:7px; text-decoration:none; margin:0 12px; transition:background 0.2s; }
    .page-btn:disabled, .disabled { background:#ccc !important; color:#888; pointer-events:none; }
    .back-btn { margin-top:30px; display:inline-block; background:#009688; color:#fff; padding:10px 18px; border-radius:8px; text-decoration:none; transition:background 0.2s; }
    .save-btn { background:#009688; color:#fff; border:none; border-radius:7px; padding:10px 20px; margin-top:15px; cursor:pointer; }
    .quiz-status { margin-left:16px; font-weight:bold; }
    .video-container { margin: 24px 0; border-radius: 8px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
    .video-wrapper { position: relative; width: 100%; padding-bottom: 56.25%; height: 0; }
    .video-wrapper iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0; }
    .end-of-chapter-quiz .question { background-color: #f9f9f9; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 5px solid #009688; }
    .end-of-chapter-quiz .question-text { font-size: 1.1em; font-weight: 600; margin-bottom: 10px; }
    .end-of-chapter-quiz .choices { display: flex; flex-direction: column; gap: 10px; }
    .end-of-chapter-quiz .choice { background-color: #fff; border: 1px solid #ddd; border-radius: 5px; padding: 10px; cursor: pointer; display: block; }
    #quizResult.correct { color: #388e3c; }
    #quizResult.incorrect { color: #d32f2f; }
  </style>
</head>
<body>
  <div class="header"><h1>รายละเอียดบทเรียน: การออมเงิน</h1></div>
  <div class="container">
    <div id="lessonDetails"></div>
    <div class="pagination" id="pagination"></div>
    <a href="lesson.html" class="back-btn">⬅ กลับสู่รายการบทเรียน</a>
  </div>
  <script>
    const lessonId = 2;
    const urlParams = new URLSearchParams(window.location.search);
    const pageNow = Number(urlParams.get("page")||1);

    const pages = [
       {
        title: "บทที่ 2: ความหมายและทำไมต้องออม (หน้า 1/5)",
        content: `
          <div>
            <b>การออมเงิน</b> คือ การแบ่งรายได้ส่วนหนึ่งเก็บไว้ ไม่นำไปใช้จ่ายทันที เพื่อเป้าหมายในอนาคต<br>
            <b>ทำไมต้องออม?</b>
            <ul>
              <li>เพื่อเป้าหมายที่ต้องการ เช่น ซื้อของ, เรียนพิเศษ</li>
              <li>เป็นเงินสำรองยามฉุกเฉิน เช่น เจ็บป่วย</li>
              <li>สร้างความมั่นคงทางการเงินในระยะยาว</li>
              <li>ฝึกวินัยและความรับผิดชอบต่อตนเอง</li>
            </ul>
          </div>
        `
      },
      {
        title: "บทที่ 2: เทคนิคการออมสำหรับวัยเรียน (หน้า 2/5)",
        content: `
          <div>
            <b>เทคนิคยอดนิยม</b><br>
            <ul>
              <li><b>ออมก่อนใช้ (Pay Yourself First):</b> ได้รับเงินมา ให้หักส่วนที่จะออมออกไปก่อนทันที 10-20% ที่เหลือค่อยนำไปใช้จ่าย</li>
              <li><b>ออมเศษเหรียญ:</b> ทุกสิ้นวัน นำเหรียญที่เหลือในกระเป๋าทั้งหมดมาหยอดกระปุก</li>
              <li><b>ตั้งเป้าหมายให้เห็นภาพ:</b> ติดรูปของที่อยากได้ไว้ที่กระปุกออมสินเพื่อสร้างแรงบันดาลใจ</li>
            </ul>
             <div class="video-container">
              <div class="video-wrapper">
                <iframe src="https://www.youtube.com/embed/OUO2unyOv78" title="YouTube video player" allowfullscreen></iframe>
              </div>
            </div>
          </div>
        `
      },
      {
        title: "บทที่ 2: ตั้งเป้าหมายการออมแบบ SMART (หน้า 3/5)",
        content: `
          <div>
            การตั้งเป้าหมายที่ดีจะช่วยให้เราออมเงินได้สำเร็จ เป้าหมายควรเป็นแบบ <b>SMART</b>:
            <ul>
              <li><b>S (Specific):</b> เฉพาะเจาะจง - จะออมเงินเพื่ออะไร? (เช่น ซื้อหูฟังไร้สาย)</li>
              <li><b>M (Measurable):</b> วัดผลได้ - ต้องใช้เงินเท่าไหร่? (เช่น 1,500 บาท)</li>
              <li><b>A (Achievable):</b> ทำได้จริง - สามารถเก็บเงินจำนวนนี้ได้หรือไม่? (เช่น เก็บเดือนละ 500 บาท)</li>
              <li><b>R (Relevant):</b> สมเหตุสมผล - สิ่งนี้สำคัญกับเราตอนนี้หรือไม่?</li>
              <li><b>T (Time-bound):</b> มีกรอบเวลา - จะเก็บเงินให้ครบภายในเมื่อไหร่? (เช่น ภายใน 3 เดือน)</li>
            </ul>
          </div>
        `
      },
      {
        title: "บทที่ 2: อุปสรรคและวิธีเอาชนะใจตัวเอง (หน้า 4/5)",
        content: `
          <div>
            <b>อุปสรรคที่พบบ่อย:</b>
            <ol>
              <li><b>ใจอ่อน:</b> เห็นของลดราคาหรือของที่อยากได้แล้วห้ามใจไม่อยู่</li>
              <li><b>ไม่มีเป้าหมาย:</b> ไม่รู้จะเก็บเงินไปทำไม เลยไม่มีแรงจูงใจ</li>
              <li><b>คิดว่าเงินน้อย:</b> รู้สึกว่าเงินค่าขนมไม่พอออม</li>
            </ol>
            <b>วิธีเอาชนะ:</b>
            <ul>
                <li>ใช้กฎ "รอ 24 ชั่วโมง" ก่อนซื้อของที่ไม่จำเป็น</li>
                <li>เขียนเป้าหมายแปะไว้ในที่ที่เห็นบ่อยๆ</li>
                <li>เริ่มต้นออมจากจำนวนน้อยๆ ก่อน เช่น วันละ 5-10 บาท เพื่อสร้างนิสัย</li>
            </ul>
          </div>
        `
      },
      {
        title: "บทที่ 2: แบบทดสอบท้ายบท (หน้า 5/5)",
        content: `
          <div class="end-of-chapter-quiz" id="end-of-chapter-quiz"></div>
          <button type="button" class="save-btn" id="checkQuizBtn">ตรวจคำตอบ</button>
          <span id="quizResult" class="quiz-status"></span>
          <div style="margin-top:16px;">
            <button id="doneBtn" class="save-btn disabled" style="background:#388e3c;">เรียนจบบทนี้</button>
            <span id="doneStatus" class="quiz-status"></span>
          </div>
        `
      }
    ];

    let page = Math.min(Math.max(pageNow,1), pages.length);
    document.getElementById("lessonDetails").innerHTML = `<div class="lesson-title">${pages[page-1].title}</div><div class="lesson-content">${pages[page-1].content}</div>`;
    let pag = "";
    if (page > 1) pag += `<a class="page-btn" href="lesson-detail2.html?page=${page-1}">หน้าก่อนหน้า</a>`;
    if (page < pages.length) pag += `<a class="page-btn" href="lesson-detail2.html?page=${page+1}">หน้าถัดไป</a>`;
    document.getElementById("pagination").innerHTML = pag;

    if (page === pages.length) {
      const quizData = [
          {
              question: "หลักการ 'ออมก่อนใช้' (Pay Yourself First) หมายถึงอะไร?",
              choices: ["ใช้เงินให้หมดก่อนสิ้นเดือน", "ได้รับเงินมาแล้วให้หักออมทันทีก่อนนำไปใช้จ่าย", "นำเงินที่เหลือจากใช้จ่ายมาออม", "ยืมเงินเพื่อนมาออมก่อน"],
              answer: "ได้รับเงินมาแล้วให้หักออมทันทีก่อนนำไปใช้จ่าย"
          },
          {
              question: "การตั้งเป้าหมายการออมแบบ SMART ตัว 'T' ย่อมาจากอะไร?",
              choices: ["Time-bound (มีกรอบเวลาชัดเจน)", "Trust (น่าเชื่อถือ)", "Tactic (กลยุทธ์)", "Total (ยอดรวม)"],
              answer: "Time-bound (มีกรอบเวลาชัดเจน)"
          },
          {
              question: "วิธีใดช่วยสร้างแรงจูงใจในการออมได้ดีที่สุด?",
              choices: ["เก็บเงินไว้ในที่ที่มองไม่เห็น", "บอกเป้าหมายให้เพื่อนฟัง", "ติดรูปภาพของที่อยากได้ไว้ที่กระปุกออมสิน", "เก็บเงินแบบไม่มีเป้าหมาย"],
              answer: "ติดรูปภาพของที่อยากได้ไว้ที่กระปุกออมสิน"
          }
      ];

      const quizContainer = document.getElementById('end-of-chapter-quiz');
      const checkButton = document.getElementById('checkQuizBtn');
      const resultContainer = document.getElementById('quizResult');
      const doneBtn = document.getElementById("doneBtn");
      const doneStatus = document.getElementById("doneStatus");

      function buildEndOfChapterQuiz() {
          quizData.forEach((currentQuestion, questionNumber) => {
              const choicesHTML = currentQuestion.choices.map(choice => `
                  <label class="choice">
                      <input type="radio" name="chapter_question${questionNumber}" value="${choice}">
                      ${choice}
                  </label>
              `).join('');
              const questionHTML = `
                  <div class="question">
                      <div class="question-text">${questionNumber + 1}. ${currentQuestion.question}</div>
                      <div class="choices">${choicesHTML}</div>
                  </div>
              `;
              quizContainer.innerHTML += questionHTML;
          });
      }

      function checkQuizAnswers() {
          const answerContainers = quizContainer.querySelectorAll('.choices');
          let numCorrect = 0;
          let allAnswered = true;
          quizData.forEach((currentQuestion, questionNumber) => {
              const selector = `input[name=chapter_question${questionNumber}]:checked`;
              const userAnswerNode = answerContainers[questionNumber].querySelector(selector);
              if (!userAnswerNode) { allAnswered = false; return; }
              if (userAnswerNode.value === currentQuestion.answer) numCorrect++;
          });

          if (!allAnswered) {
              resultContainer.textContent = "กรุณาตอบคำถามให้ครบทุกข้อ";
              resultContainer.className = "quiz-status incorrect";
              return;
          }
          if (numCorrect === quizData.length) {
              resultContainer.textContent = "เก่งมาก! คุณตอบถูกทุกข้อ";
              resultContainer.className = "quiz-status correct";
              doneBtn.disabled = false;
              doneBtn.classList.remove('disabled');
              doneStatus.textContent = "ตอนนี้คุณสามารถกดยืนยันเพื่อจบบทเรียนได้แล้ว!";
          } else {
              resultContainer.textContent = `พยายามอีกนิด! คุณตอบถูก ${numCorrect} จาก ${quizData.length} ข้อ`;
              resultContainer.className = "quiz-status incorrect";
              doneBtn.disabled = true;
              doneBtn.classList.add('disabled');
              doneStatus.textContent = "";
          }
      }
      
      function checkInitialDoneStatus() {
          if (localStorage.getItem(`MoneySkillz-lesson${lessonId}-done`) === "yes") {
              doneStatus.innerHTML = "คุณเรียนจบบทนี้แล้ว!";
              doneBtn.disabled = true;
              doneBtn.classList.add('disabled');
              checkButton.style.display = 'none';
              resultContainer.style.display = 'none';
          }
      }

      buildEndOfChapterQuiz();
      checkButton.addEventListener('click', checkQuizAnswers);
      doneBtn.addEventListener('click', () => {
          localStorage.setItem(`MoneySkillz-lesson${lessonId}-done`, "yes");
          checkInitialDoneStatus();
      });
      checkInitialDoneStatus();
    }
  </script>
 <script src="darkmode-toggle.js"></script>
</body>
</html>
